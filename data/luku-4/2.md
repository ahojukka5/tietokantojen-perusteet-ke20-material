---
path: '/luku-4/2'
title: 'NULL-arvot'
hidden: false
---

NULL on erityinen arvo, joka ilmaisee,
että taulun sarakkeessa ei ole tietoa tai
jokin kyselyn osa ei tuottanut tietoa.
NULL on tietyissä tilanteissa kätevä,
mutta voi aiheuttaa myös yllätyksiä.

## NULL-arvon ominaisuuksia

NULL on selkeästi eri asia kuin luku 0.
Jos NULL esiintyy laskun osana, niin koko
laskun tulokseksi tulee NULL.
SQLite-tulkki näyttää tällöin vain tyhjän rivin:

```x
sqlite> SELECT NULL;

sqlite> SELECT 5+NULL;

sqlite> SELECT 2*NULL+1;

```

Myöskään tavallinen vertailu ei tuota tulosta,
jos verrattavana on NULL:

```x
sqlite> SELECT 5 = NULL;

sqlite> SELECT 5 <> NULL;

```

Tämä on yllättävää, koska yleensä lausekkeille
`a` ja `b` pätee joko `a = b ` tai `a <> b`.
Voimme kuitenkin tutkia erityisen syntaksin
`IS NULL` avulla, onko lausekkeen arvo NULL:

```x
sqlite> SELECT 5 IS NULL;
0
sqlite> SELECT NULL IS NULL;
1
```

## Sarakkeen puuttuva tieto

NULL-arvon yksi käyttötarkoitus on ilmaista,
että jossain sarakkeessa ei ole tietoa.
Esimerkiksi seuraavassa taulussa Dumbon
vuosi puuttuu, joten sen kohdalla on NULL:

```x
sqlite> SELECT * FROM Elokuvat;
id          nimi        vuosi     
----------  ----------  ----------
1           Lumikki     1937      
2           Fantasia    1940      
3           Pinocchio   1940      
4           Dumbo                 
5           Bambi       1942  
```

Kun haemme ensin vuoden 1940 elokuvat ja sitten
kaikki elokuvat muilta vuosilta, saamme seuraavat tulokset:

```x
sqlite> SELECT * FROM Elokuvat WHERE vuosi=1940;
id          nimi        vuosi     
----------  ----------  ----------
2           Fantasia    1940      
3           Pinocchio   1940      
sqlite> SELECT * FROM Elokuvat WHERE vuosi<>1940;
id          nimi        vuosi     
----------  ----------  ----------
1           Lumikki     1937      
5           Bambi       1942      
```

Koska Dumbolla ei ole vuotta, emme saa sitä kummassakaan
kyselyssä, mikä on yllättävä ilmiö.
Voimme kuitenkin hakea näin elokuvat, joilla ei ole vuotta:

```x
sqlite> SELECT * FROM Elokuvat WHERE vuosi IS NULL;
id          nimi        vuosi     
----------  ----------  ----------
4           Dumbo            
```

## NULL-arvo koostefunktiossa

Kun koostefunktion sisällä on lauseke (kuten sarake),
riviä ei lasketa mukaan, jos lausekkeen arvo on NULL.
Esimerkiksi äskeisessä taulussamme käy näin:

```x
sqlite> SELECT COUNT(*) FROM Elokuvat;
COUNT(*)  
----------
5         
sqlite> SELECT COUNT(vuosi) FROM Elokuvat;
COUNT(vuosi)
------------
4           
```

Tässä `COUNT(*)` laskee mukaan kaikki rivit,
mutta `COUNT(vuosi)` vain rivit, joissa sarakkeen
`vuosi` arvo ei ole NULL.

NULL-arvo voi myös ilmestyä kummittelemaan `LEFT JOIN` -kyselyyn,
jossa lasketaan summaa. Näin käy seuraavassa tilanteessa:

```x
sqlite> SELECT * FROM Henkilot;
id          nimi      
----------  ----------
1           Anna      
2           Liisa     
3           Uolevi    
sqlite> SELECT * FROM Palkat;
id          henkilo_id  palkka    
----------  ----------  ----------
1           1           3000      
2           2           2500      
3           2           2000      
sqlite> SELECT H.nimi, SUM(P.palkka) FROM Henkilot H
        LEFT JOIN Palkat P ON H.id = P.henkilo_id GROUP BY H.id;
nimi        SUM(P.palkka)
----------  -------------
Anna        3000         
Liisa       4500         
Uolevi      
```

Koska Uolevi ei ole saanut koskaan palkkaa, `SUM`-funktion tulos on NULL,
vaikka haluttu tulos olisi 0.
Voimme ratkaista asian käyttämällä `IFNULL`-funktiota:

```x
sqlite> SELECT H.nimi, IFNULL(SUM(P.palkka),0) FROM Henkilot H
        LEFT JOIN Palkat P ON H.id = P.henkilo_id GROUP BY H.id;
nimi        IFNULL(SUM(P.palkka),0)
----------  -----------------------
Anna        3000                   
Liisa       4500                   
Uolevi      0            
```

Ideana on, että `IFNULL(a,b)` antaa arvon `a`, jos `a` ei ole NULL,
mutta arvon `b`, jos `a` on NULL.
Voimme siis antaa korvaavan arvon mahdolliselle NULL-arvolle.
Funktion yleistys on `COALESCE(...)`, joka antaa listan ensimmäisen arvon,
joka ei ole NULL.
